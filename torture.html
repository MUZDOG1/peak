<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>torture them.</title>
  <style>
    body {
      margin: 0;
      background: #111;
      color: #fff;
      font-family: sans-serif;
      text-align: center;
    }
    #gameCanvas {
      background: #222;
      display: block;
      margin: 20px auto;
      border: 2px solid #444;
    }
    #instructions {
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>kill them all.</h1>
  <p id="instructions">Left click to hit.</p>
  <canvas id="gameCanvas" width="800" height="600"></canvas>
  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    // Load the image for the attacker
    const attackerImage = new Image();
    attackerImage.src = 'idle.png';

    // Load the normal enemy image
    const enemyImage = new Image();
    enemyImage.src = 'enemyidle.png';

    // Load the enemy hit image
    const hitImage = new Image();
    hitImage.src = 'hit.png';

    // Game objects
    const attacker = {
      x: 100,
      y: 300,
      width: 50,
      height: 50,
      speed: 5
    };

    const target = {
      x: 600,
      y: 300,
      width: 50,
      height: 50,
      isHurt: false // Used to track hit state
    };

    // This flag will determine if we display the hit image
    let enemyHit = false;

    // Keyboard state for movement
    const keys = {};

    window.addEventListener('keydown', (e) => {
      keys[e.key] = true;
    });

    window.addEventListener('keyup', (e) => {
      keys[e.key] = false;
    });

    // Listen for left mouse click to trigger the hit
    canvas.addEventListener('mousedown', (e) => {
      if (e.button === 0) { // Left mouse button
        if (isColliding(attacker, target)) {
          enemyHit = true;
          target.isHurt = true;
          console.log("Torture interaction triggered!");
          // After 1 second, revert back to normal state
          setTimeout(() => {
            enemyHit = false;
            target.isHurt = false;
          }, 1000);
        }
      }
    });

    // Basic collision detection between two rectangles
    function isColliding(a, b) {
      return (
        a.x < b.x + b.width &&
        a.x + a.width > b.x &&
        a.y < b.y + b.height &&
        a.y + a.height > b.y
      );
    }

    function update() {
      // Movement controls for the attacker using arrow keys
      if (keys['ArrowUp']) attacker.y -= attacker.speed;
      if (keys['ArrowDown']) attacker.y += attacker.speed;
      if (keys['ArrowLeft']) attacker.x -= attacker.speed;
      if (keys['ArrowRight']) attacker.x += attacker.speed;

      // Keep attacker within canvas bounds
      attacker.x = Math.max(0, Math.min(canvas.width - attacker.width, attacker.x));
      attacker.y = Math.max(0, Math.min(canvas.height - attacker.height, attacker.y));
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw the enemy:
      // If enemy was hit and hit image is loaded, display it.
      if (enemyHit && hitImage.complete) {
        ctx.drawImage(hitImage, target.x, target.y, target.width, target.height);
      } else if (enemyImage.complete) {
        ctx.drawImage(enemyImage, target.x, target.y, target.width, target.height);
      } else {
        // Fallback: Draw a rectangle (orange if hurt, red otherwise)
        ctx.fillStyle = target.isHurt ? 'orange' : 'red';
        ctx.fillRect(target.x, target.y, target.width, target.height);
      }

      // Draw the attacker using its image or a blue rectangle as fallback
      if (attackerImage.complete) {
        ctx.drawImage(attackerImage, attacker.x, attacker.y, attacker.width, attacker.height);
      } else {
        ctx.fillStyle = 'blue';
        ctx.fillRect(attacker.x, attacker.y, attacker.width, attacker.height);
      }
    }

    function gameLoop() {
      update();
      draw();
      requestAnimationFrame(gameLoop);
    }

    // Start the game loop
    gameLoop();
  </script>
</body>
</html>

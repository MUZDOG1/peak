<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>torture them.</title>
  <style>
    body {
      margin: 0;
      background: #111;
      color: #fff;
      font-family: sans-serif;
      text-align: center;
    }
    #gameCanvas {
      background: #222;
      display: block;
      margin: 20px auto;
      border: 2px solid #444;
    }
    #instructions {
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>kill them all.</h1>
  <p id="instructions">Press SPACE to hit when near the enemy.</p>
  <canvas id="gameCanvas" width="800" height="600"></canvas>
  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    // Load the images for the attacker and enemy
    const attackerImage = new Image();
    attackerImage.src = 'idle.png';

    const enemyImage = new Image();
    enemyImage.src = 'enemyidle.png';

    const hitImage = new Image();
    hitImage.src = 'hit.png';

    // Game objects
    const attacker = {
      x: 100,
      y: 300,
      width: 50,
      height: 50,
      speed: 5
    };

    const target = {
      x: 600,
      y: 300,
      width: 50,
      height: 50,
      isHurt: false // Used to track hit state
    };

    // Flag to show hit image
    let enemyHit = false;

    // Keyboard state for movement
    const keys = {};

    window.addEventListener('keydown', (e) => {
      keys[e.key] = true;
      // Trigger hit interaction on space press if near the enemy
      if (e.key === ' ') {
        if (isNear(attacker, target, 100)) {  // 100-pixel threshold
          target.isHurt = true;
          enemyHit = true;
          console.log("Torture interaction triggered!");
          // After 1 second, revert back to normal
          setTimeout(() => {
            target.isHurt = false;
            enemyHit = false;
          }, 1000);
        }
      }
    });

    window.addEventListener('keyup', (e) => {
      keys[e.key] = false;
    });

    // Check if attacker is near the target (distance between centers)
    function isNear(a, b, threshold) {
      const ax = a.x + a.width / 2;
      const ay = a.y + a.height / 2;
      const bx = b.x + b.width / 2;
      const by = b.y + b.height / 2;
      const distance = Math.hypot(ax - bx, ay - by);
      return distance <= threshold;
    }

    function update() {
      // Movement controls for the attacker using arrow keys
      if (keys['ArrowUp']) attacker.y -= attacker.speed;
      if (keys['ArrowDown']) attacker.y += attacker.speed;
      if (keys['ArrowLeft']) attacker.x -= attacker.speed;
      if (keys['ArrowRight']) attacker.x += attacker.speed;

      // Keep attacker within canvas bounds
      attacker.x = Math.max(0, Math.min(canvas.width - attacker.width, attacker.x));
      attacker.y = Math.max(0, Math.min(canvas.height - attacker.height, attacker.y));
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw the enemy:
      if (enemyHit && hitImage.complete) {
        ctx.drawImage(hitImage, target.x, target.y, target.width, target.height);
      } else if (enemyImage.complete) {
        ctx.drawImage(enemyImage, target.x, target.y, target.width, target.height);
      } else {
        ctx.fillStyle = target.isHurt ? 'orange' : 'red';
        ctx.fillRect(target.x, target.y, target.width, target.height);
      }

      // Draw the attacker using its image (or fallback to a blue rectangle)
      if (attackerImage.complete) {
        ctx.drawImage(attackerImage, attacker.x, attacker.y, attacker.width, attacker.height);
      } else {
        ctx.fillStyle = 'blue';
        ctx.fillRect(attacker.x, attacker.y, attacker.width, attacker.height);
      }
    }

    function gameLoop() {
      update();
      draw();
      requestAnimationFrame(gameLoop);
    }

    // Start the game loop
    gameLoop();
  </script>
</body>
</html>
